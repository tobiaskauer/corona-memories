{"remainingRequest":"/Users/tk/GitHub/corona-memories/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/tk/GitHub/corona-memories/client/src/App.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/tk/GitHub/corona-memories/client/src/App.vue","mtime":1613564212562},{"path":"/Users/tk/GitHub/corona-memories/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tk/GitHub/corona-memories/client/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/tk/GitHub/corona-memories/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tk/GitHub/corona-memories/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBtZW1vcnlGb3JtIGZyb20gJy4vY29tcG9uZW50cy9tZW1vcnlGb3JtJwppbXBvcnQgKiBhcyBkMyBmcm9tICdkMycKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQXBwJywKICBjb21wb25lbnRzOiB7CiAgICBtZW1vcnlGb3JtCiAgfSwKCiAgZGF0YSAoKSB7CiAgICByZXR1cm4gewogICAgICBjdXJyZW50Q291bnRyeTogJ0dlcm1hbnknLAogICAgICBtb3VudGVkOiBmYWxzZSwKICAgICAgb3BhY2l0eTogLjcsCiAgICAgIHdpZHRoOiAwLAogICAgICBoZWlnaHQ6IDAsCiAgICAgIG1hcmdpbjoge3RvcDogNTAsIHJpZ2h0OiA1MCwgYm90dG9tOiA1MCwgbGVmdDogNTB9LAogICAgICBtZXRyaWM6ICdyZWxhdGl2ZScsCiAgICAgIGNzdjogbnVsbCwKICAgIH0KICB9LAoKICBjb21wdXRlZDogewogICAgc2NhbGVzOiBmdW5jdGlvbigpIHsKICAgICAgaWYoIXRoaXMuY3N2KSByZXR1cm4gbnVsbAogICAgICBsZXQgeURvbWFpbiA9IFswLDIwMF0vL2QzLm1heCh0aGlzLmNzdiwgZD0+K2RbdGhpcy5tZXRyaWNdKV0KICAgICAgbGV0IHhEb21haW4gPSBkMy5leHRlbnQodGhpcy5jc3YsIGQ9PmQuZGF0ZSkKICAgICAgcmV0dXJuIHsKICAgICAgICB4OiBkMy5zY2FsZVRpbWUoKS5kb21haW4oeERvbWFpbikucmFuZ2UoW3RoaXMubWFyZ2luLmxlZnQsdGhpcy53aWR0aC10aGlzLm1hcmdpbi5sZWZ0LXRoaXMubWFyZ2luLnJpZ2h0XSksCiAgICAgICAgeTogZDMuc2NhbGVMaW5lYXIoKS5kb21haW4oeURvbWFpbikucmFuZ2UoW3RoaXMuaGVpZ2h0LXRoaXMubWFyZ2luLmJvdHRvbS10aGlzLm1hcmdpbi50b3AsdGhpcy5tYXJnaW4udG9wXSkKICAgICAgfQogICAgfSwKCiAgICByZWFjdGlvbnM6IGZ1bmN0aW9uKCl7CiAgICAgIGlmKCF0aGlzLmNvdW50cmllcykgcmV0dXJuIGZhbHNlCgogICAgICBsZXQgZm9ybWF0VGltZSA9IGQzLnRpbWVGb3JtYXQoIiVtLyVkLyV5IikKICAgICAgbGV0IHJlYWN0aW9uQXJyID0gW10gLy9jcmVhdGUgc2FtcGxlIHJlYWN0aW9ucwogICAgICBPYmplY3Qua2V5cyh0aGlzLmNvdW50cmllcykuZm9yRWFjaChjb3VudHJ5ID0+IHsKICAgICAgICBkMy5yYW5nZSgzMDApLmZvckVhY2goKCkgPT4gewogICAgICAgICAgbGV0IGRhdGUgPSB0aGlzLmdldFJhbmRvbURhdGUodGhpcy5zY2FsZXMueC5kb21haW4oKSkKICAgICAgICAgIHJlYWN0aW9uQXJyLnB1c2goewogICAgICAgICAgICBkYXRlOiBkYXRlLAogICAgICAgICAgICB2YWx1ZTogdGhpcy5jb3VudHJpZXNbY291bnRyeV0uY2FzZXMuZmluZChjID0+IGZvcm1hdFRpbWUoYy5kYXRlKSA9PSBmb3JtYXRUaW1lKGRhdGUpKVt0aGlzLm1ldHJpY10sCiAgICAgICAgICAgIGNvbW1lbnQ6ICJmb29iYXIiLAogICAgICAgICAgICB3ZWlnaHQ6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSozKzIpLAogICAgICAgICAgICBjb3VudHJ5OiBjb3VudHJ5LAogICAgICAgICAgfSkKICAgICAgICB9KQogICAgICB9KQoKICAgICAgbGV0IGZvcmNlID0gZDMuZm9yY2VTaW11bGF0aW9uKHJlYWN0aW9uQXJyKQogICAgICAgLmZvcmNlKCdmb3JjZVgnLCBkMy5mb3JjZVgocmVhY3Rpb24gPT4gdGhpcy5zY2FsZXMueChyZWFjdGlvbi5kYXRlKSkuc3RyZW5ndGgoLjEpKQogICAgICAgLmZvcmNlKCdmb3JjZVknLCBkMy5mb3JjZVkoKHJlYWN0aW9uLGkpID0+IHRoaXMuc2NhbGVzLnkocmVhY3Rpb24udmFsdWUpICsgKC04ICsgKGklMikqMTYpKS5zdHJlbmd0aCguMSkpCiAgICAgICAuZm9yY2UoJ2NvbGxpZGUnLCBkMy5mb3JjZUNvbGxpZGUoZCA9PiBkLndlaWdodCkpCiAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZWFjdGlvbkFyci5sZW5ndGg7ICsraSkgewogICAgICAgZm9yY2UudGljaygpCiAgICAgfQogICAgIHJldHVybiBmb3JjZS5ub2RlcygpCgogICAgfSwKCiAgICBjb3VudHJpZXM6IGZ1bmN0aW9uKCkgewogICAgICBpZighdGhpcy5jc3YgfHwgIXRoaXMuc2NhbGVzKSByZXR1cm4gZmFsc2UKCiAgICAgIGNvbnN0IGxpbmVHZW5lcmF0b3IgPSBkMy5saW5lKCkKICAgICAgICAvLy5jdXJ2ZShkMy5jdXJ2ZUJhc2lzKQogICAgICAgIC54KGQgPT4gdGhpcy5zY2FsZXMueChkLmRhdGUpKQogICAgICAgIC55KGQgPT4gdGhpcy5zY2FsZXMueShkW3RoaXMubWV0cmljXSkpCgogICAgIGxldCBjb3VudHJpZXNNYXAgPSBkMy5ncm91cCh0aGlzLmNzdiwgZCA9PiBkLmNvdW50cnkpCiAgICAgbGV0IGNvdW50cmllc09iaiA9IE9iamVjdC5mcm9tRW50cmllcyhjb3VudHJpZXNNYXApCiAgICAgT2JqZWN0LmtleXMoY291bnRyaWVzT2JqKS5tYXAoKGtleSxpKSA9PiB7CiAgICAgICBjb3VudHJpZXNPYmpba2V5XSA9IHsKICAgICAgICAgaWQ6IGksCiAgICAgICAgIGNhc2VzOiBjb3VudHJpZXNPYmpba2V5XSwKICAgICAgICAgbGluZTogbGluZUdlbmVyYXRvcihjb3VudHJpZXNPYmpba2V5XSksCiAgICAgICAgIG5hbWU6IGtleQogICAgICAgfQogICAgIH0pCiAgICAgcmV0dXJuIGNvdW50cmllc09iagogICAgfSwKICB9LAoKICBjcmVhdGVkKCkgewogICAgLy90aGlzLiRzdG9yZS5jb21taXQoImNhbGxBUEkiLHtmb286ICdiYXInfSkKICAgIGNvbnN0IHBhcnNlRGF0ZSA9IGQzLnV0Y1BhcnNlKCIlbS8lZC8leSIpCiAgICBkMy5jc3YoJ2RhdGEuY3N2JykudGhlbihkID0+IHsKICAgICAgdGhpcy5jc3YgPSBkLm1hcChyb3cgPT4gewogICAgICAgIHJvdy5uYW1lID0gcm93LmNvdW50cnkKICAgICAgICByb3cuZGF0ZSA9IHBhcnNlRGF0ZShyb3cuZGF0ZSkKICAgICAgICByZXR1cm4gcm93CiAgICAgIH0pCiAgICAgICAgICAuZmlsdGVyKGQ9PiBkLmNvdW50cnkgPT0gIkdlcm1hbnkiKQogICAgfSkKCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicmVzaXplIiwgdGhpcy5yZXNpemUpOwogIH0sCgogIG1vdW50ZWQoKSB7CgogICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICB0aGlzLnJlc2l6ZSgpCiAgICAgIHRoaXMubW91bnRlZCA9IHRydWU7CiAgICB9KQogIH0sCgogIG1ldGhvZHM6IHsKICAgIGdldFJhbmRvbURhdGU6IGZ1bmN0aW9uKGV4dGVudCkgewogICAgICBsZXQgZGF0ZSA9IG5ldyBEYXRlKGV4dGVudFswXS5nZXRUaW1lKCkgKyBNYXRoLnJhbmRvbSgpICogKGV4dGVudFsxXS5nZXRUaW1lKCkgLSBleHRlbnRbMF0uZ2V0VGltZSgpKSkKICAgICAgZGF0ZS5zZXRIb3VycygwLDAsMCkKICAgICAgcmV0dXJuIGRhdGUKICAgIH0sCgogICAgcmVzaXplOiBmdW5jdGlvbigpIHsKICAgICAgdGhpcy53aWR0aCA9IHRoaXMuJHJlZnMuY29udGFpbmVyLm9mZnNldFdpZHRoCiAgICAgIHRoaXMuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0CiAgICB9LAoKICAgIGhvdmVyOiBmdW5jdGlvbihyZWFjdGlvbixldmVudCkgewogICAgICBsZXQgciA9IDEwCiAgICAgIGxldCBvcGFjaXR5ID0gMQogICAgICBpZihldmVudC50eXBlID09ICdtb3VzZW91dCcpIHsKICAgICAgICByID0gcmVhY3Rpb24ud2VpZ2h0CiAgICAgICAgb3BhY2l0eSA9IHRoaXMub3BhY2l0eQogICAgICB9CiAgICAgIGQzLnNlbGVjdChldmVudC50YXJnZXQpLnRyYW5zaXRpb24oIjUwIikuYXR0cigiciIscikuYXR0cigib3BhY2l0eSIsb3BhY2l0eSkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n  <div class=\"wrapper\">\n    <div id=\"app\" class=\"container-fluid\" ref=\"container\">\n      <memoryForm />\n      <svg :width=\"width\" :height=\"height\" v-if=\"mounted\">\n        <defs>\n          <filter id=\"f0\"><feGaussianBlur in=\"SourceGraphic\" :stdDeviation=\"1\" /></filter>\n          <filter id=\"f1\"><feGaussianBlur in=\"SourceGraphic\" :stdDeviation=\"3\" /></filter>\n          <filter id=\"f1\"><feGaussianBlur in=\"SourceGraphic\" :stdDeviation=\"5\" /></filter>\n        </defs>\n\n        <g class=\"lines\" v-if=\"countries\">\n          <path\n            v-for=\"country,i in countries\"\n            :key=\"i\"\n            :d=\"country.line\"\n            stroke-width=\"3\"\n            :class=\"(country.name == currentCountry) ? 'active' : 'hidden-'+(country.id%3)\" />\n        </g>\n\n        <g class=\"reactions\" v-if=\"reactions\" transform=\"translate(0,0)\">\n          <circle\n            v-for=\"reaction, j in reactions\"\n            :key=\"j\" :cx=\"reaction.x\"\n            :cy=\"reaction.y\"\n            :opacity=\"opacity\"\n            :class=\"(reaction.country == currentCountry) ? 'active' : 'hidden-1'\"\n            :r=\"reaction.weight\"\n            fill=\"#FA5E2D\"\n            @mouseover=\"hover(reaction,$event)\"\n            @mouseout=\"hover(reaction,$event)\" />\n        </g>\n      </svg>\n    </div>\n  </div>\n</template>\n\n<script>\nimport memoryForm from './components/memoryForm'\nimport * as d3 from 'd3'\n\nexport default {\n  name: 'App',\n  components: {\n    memoryForm\n  },\n\n  data () {\n    return {\n      currentCountry: 'Germany',\n      mounted: false,\n      opacity: .7,\n      width: 0,\n      height: 0,\n      margin: {top: 50, right: 50, bottom: 50, left: 50},\n      metric: 'relative',\n      csv: null,\n    }\n  },\n\n  computed: {\n    scales: function() {\n      if(!this.csv) return null\n      let yDomain = [0,200]//d3.max(this.csv, d=>+d[this.metric])]\n      let xDomain = d3.extent(this.csv, d=>d.date)\n      return {\n        x: d3.scaleTime().domain(xDomain).range([this.margin.left,this.width-this.margin.left-this.margin.right]),\n        y: d3.scaleLinear().domain(yDomain).range([this.height-this.margin.bottom-this.margin.top,this.margin.top])\n      }\n    },\n\n    reactions: function(){\n      if(!this.countries) return false\n\n      let formatTime = d3.timeFormat(\"%m/%d/%y\")\n      let reactionArr = [] //create sample reactions\n      Object.keys(this.countries).forEach(country => {\n        d3.range(300).forEach(() => {\n          let date = this.getRandomDate(this.scales.x.domain())\n          reactionArr.push({\n            date: date,\n            value: this.countries[country].cases.find(c => formatTime(c.date) == formatTime(date))[this.metric],\n            comment: \"foobar\",\n            weight: Math.floor(Math.random()*3+2),\n            country: country,\n          })\n        })\n      })\n\n      let force = d3.forceSimulation(reactionArr)\n       .force('forceX', d3.forceX(reaction => this.scales.x(reaction.date)).strength(.1))\n       .force('forceY', d3.forceY((reaction,i) => this.scales.y(reaction.value) + (-8 + (i%2)*16)).strength(.1))\n       .force('collide', d3.forceCollide(d => d.weight))\n     for (let i = 0; i < reactionArr.length; ++i) {\n       force.tick()\n     }\n     return force.nodes()\n\n    },\n\n    countries: function() {\n      if(!this.csv || !this.scales) return false\n\n      const lineGenerator = d3.line()\n        //.curve(d3.curveBasis)\n        .x(d => this.scales.x(d.date))\n        .y(d => this.scales.y(d[this.metric]))\n\n     let countriesMap = d3.group(this.csv, d => d.country)\n     let countriesObj = Object.fromEntries(countriesMap)\n     Object.keys(countriesObj).map((key,i) => {\n       countriesObj[key] = {\n         id: i,\n         cases: countriesObj[key],\n         line: lineGenerator(countriesObj[key]),\n         name: key\n       }\n     })\n     return countriesObj\n    },\n  },\n\n  created() {\n    //this.$store.commit(\"callAPI\",{foo: 'bar'})\n    const parseDate = d3.utcParse(\"%m/%d/%y\")\n    d3.csv('data.csv').then(d => {\n      this.csv = d.map(row => {\n        row.name = row.country\n        row.date = parseDate(row.date)\n        return row\n      })\n          .filter(d=> d.country == \"Germany\")\n    })\n\n    window.addEventListener(\"resize\", this.resize);\n  },\n\n  mounted() {\n\n    this.$nextTick(() => {\n      this.resize()\n      this.mounted = true;\n    })\n  },\n\n  methods: {\n    getRandomDate: function(extent) {\n      let date = new Date(extent[0].getTime() + Math.random() * (extent[1].getTime() - extent[0].getTime()))\n      date.setHours(0,0,0)\n      return date\n    },\n\n    resize: function() {\n      this.width = this.$refs.container.offsetWidth\n      this.height = window.innerHeight\n    },\n\n    hover: function(reaction,event) {\n      let r = 10\n      let opacity = 1\n      if(event.type == 'mouseout') {\n        r = reaction.weight\n        opacity = this.opacity\n      }\n      d3.select(event.target).transition(\"50\").attr(\"r\",r).attr(\"opacity\",opacity)\n    }\n  }\n}\n</script>\n\n<style>\n@import url('https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css');\n\n.wrapper {\n  width: 100%;\n  height: 100%;\n  //background: radial-gradient(83.17% 83.17% at 18.37% 16.83%, #20CB86 0%, #15B5B5 100%);/* Rectangle 237 */\n  //background: linear-gradient(121.09deg, #64033D 16.58%, #100530 82.74%);\n}\n\n#app {\n  min-height: 100%;\n  height: 100%\n}\n\n.hidden-0, .hidden-1, .hidden-2 {\n  fill-opacity: .2;\n  stroke-opacity: .5;\n}\n.hidden-0 {filter: url('#f0')}\n.hidden-1 {filter: url('#f1')}\n.hidden-2 {filter: url('#f2')}\n\npath {\n  fill: none;\n  stroke: black;\n}\n</style>\n"]}]}