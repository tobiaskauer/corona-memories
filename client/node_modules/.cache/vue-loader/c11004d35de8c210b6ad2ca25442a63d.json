{"remainingRequest":"/Users/tk/GitHub/corona-memories/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/tk/GitHub/corona-memories/src/App.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/Users/tk/GitHub/corona-memories/src/App.vue","mtime":1613550669534},{"path":"/Users/tk/GitHub/corona-memories/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tk/GitHub/corona-memories/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/tk/GitHub/corona-memories/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/tk/GitHub/corona-memories/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tk/GitHub/corona-memories/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKQGltcG9ydCB1cmwoJ2h0dHBzOi8vc3RhY2twYXRoLmJvb3RzdHJhcGNkbi5jb20vYm9vdHN0cmFwLzQuMy4xL2Nzcy9ib290c3RyYXAubWluLmNzcycpOwoKLndyYXBwZXIgewogIHdpZHRoOiAxMDAlOwogIGhlaWdodDogMTAwJTsKICAvL2JhY2tncm91bmQ6IHJhZGlhbC1ncmFkaWVudCg4My4xNyUgODMuMTclIGF0IDE4LjM3JSAxNi44MyUsICMyMENCODYgMCUsICMxNUI1QjUgMTAwJSk7LyogUmVjdGFuZ2xlIDIzNyAqLwogIC8vYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEyMS4wOWRlZywgIzY0MDMzRCAxNi41OCUsICMxMDA1MzAgODIuNzQlKTsKfQoKI2FwcCB7CiAgbWluLWhlaWdodDogMTAwJTsKICBoZWlnaHQ6IDEwMCUKfQoKLmhpZGRlbi0wLCAuaGlkZGVuLTEsIC5oaWRkZW4tMiB7CiAgZmlsbC1vcGFjaXR5OiAuMjsKICBzdHJva2Utb3BhY2l0eTogLjU7Cn0KLmhpZGRlbi0wIHtmaWx0ZXI6IHVybCgnI2YwJyl9Ci5oaWRkZW4tMSB7ZmlsdGVyOiB1cmwoJyNmMScpfQouaGlkZGVuLTIge2ZpbHRlcjogdXJsKCcjZjInKX0KCnBhdGggewogIGZpbGw6IG5vbmU7CiAgc3Ryb2tlOiBibGFjazsKfQo="},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2KA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n  <div class=\"wrapper\">\n    <div id=\"app\" class=\"container-fluid\" ref=\"container\">\n\n      <svg :width=\"width\" :height=\"height\" v-if=\"mounted\">\n        <defs>\n          <filter id=\"f0\"><feGaussianBlur in=\"SourceGraphic\" :stdDeviation=\"1\" /></filter>\n          <filter id=\"f1\"><feGaussianBlur in=\"SourceGraphic\" :stdDeviation=\"3\" /></filter>\n          <filter id=\"f1\"><feGaussianBlur in=\"SourceGraphic\" :stdDeviation=\"5\" /></filter>\n        </defs>\n\n        <g class=\"lines\" v-if=\"countries\">\n          <path\n            v-for=\"country,i in countries\"\n            :key=\"i\"\n            :d=\"country.line\"\n            stroke-width=\"2\"\n            :class=\"(country.name == currentCountry) ? 'active' : 'hidden-'+(country.id%3)\" />\n        </g>\n\n        <g class=\"reactions\" v-if=\"reactions\" transform=\"translate(0,0)\">\n          <circle\n            v-for=\"reaction, j in reactions\"\n            :key=\"j\" :cx=\"reaction.x\"\n            :cy=\"reaction.y\"\n            :opacity=\"opacity\"\n            :class=\"(reaction.country == currentCountry) ? 'active' : 'hidden-1'\"\n            :r=\"reaction.weight\"\n            fill=\"#FA5E2D\"\n            @mouseover=\"hover(reaction,$event)\"\n            @mouseout=\"hover(reaction,$event)\" />\n        </g>\n      </svg>\n    </div>\n  </div>\n</template>\n\n<script>\n//import vis from './components/vis'\nimport * as d3 from 'd3'\n\nexport default {\n  name: 'App',\n  components: {\n\n  },\n\n  data () {\n    return {\n      currentCountry: 'Germany',\n      mounted: false,\n      opacity: .7,\n      width: 0,\n      height: 0,\n      margin: {top: 50, right: 50, bottom: 50, left: 50},\n      metric: 'relative',\n      csv: null,\n    }\n  },\n\n  computed: {\n    scales: function() {\n      if(!this.csv) return null\n      let yDomain = [0,200]//d3.max(this.csv, d=>+d[this.metric])]\n      let xDomain = d3.extent(this.csv, d=>d.date)\n      return {\n        x: d3.scaleTime().domain(xDomain).range([this.margin.left,this.width-this.margin.left-this.margin.right]),\n        y: d3.scaleLinear().domain(yDomain).range([this.height-this.margin.bottom-this.margin.top,this.margin.top])\n      }\n    },\n\n    reactions: function(){\n      if(!this.countries) return false\n\n      let formatTime = d3.timeFormat(\"%m/%d/%y\")\n      let reactionArr = [] //create sample reactions\n      Object.keys(this.countries).forEach(country => {\n        d3.range(300).forEach(() => {\n          let date = this.getRandomDate(this.scales.x.domain())\n          reactionArr.push({\n            date: date,\n            value: this.countries[country].cases.find(c => formatTime(c.date) == formatTime(date))[this.metric],\n            comment: \"foobar\",\n            weight: Math.floor(Math.random()*3+2),\n            country: country,\n          })\n        })\n      })\n\n      let force = d3.forceSimulation(reactionArr)\n       .force('forceX', d3.forceX(reaction => this.scales.x(reaction.date)).strength(.1))\n       .force('forceY', d3.forceY((reaction,i) => this.scales.y(reaction.value) + (-8 + (i%2)*16)).strength(.1))\n       .force('collide', d3.forceCollide(d => d.weight))\n     for (let i = 0; i < reactionArr.length; ++i) {\n       force.tick()\n     }\n     return force.nodes()\n\n    },\n\n    countries: function() {\n      if(!this.csv || !this.scales) return false\n\n      const lineGenerator = d3.line()\n        .curve(d3.curveBasis)\n        .x(d => this.scales.x(d.date))\n        .y(d => this.scales.y(d[this.metric]))\n\n     let countriesMap = d3.group(this.csv, d => d.country)\n     let countriesObj = Object.fromEntries(countriesMap)\n     Object.keys(countriesObj).map((key,i) => {\n       countriesObj[key] = {\n         id: i,\n         cases: countriesObj[key],\n         line: lineGenerator(countriesObj[key]),\n         name: key\n       }\n     })\n     return countriesObj\n    },\n  },\n\n  created() {\n    //this.$store.commit(\"callAPI\",{foo: 'bar'})\n    const parseDate = d3.utcParse(\"%m/%d/%y\")\n    d3.csv('data.csv').then(d => {\n      this.csv = d.map(row => {\n        row.name = row.country\n        row.date = parseDate(row.date)\n        return row\n      })\n      .filter(d=> d.country == \"Germany\")\n    })\n\n    window.addEventListener(\"resize\", this.resize);\n  },\n\n  mounted() {\n\n    this.$nextTick(() => {\n      this.resize()\n      this.mounted = true;\n    })\n  },\n\n  methods: {\n    getRandomDate: function(extent) {\n      let date = new Date(extent[0].getTime() + Math.random() * (extent[1].getTime() - extent[0].getTime()))\n      date.setHours(0,0,0)\n      return date\n    },\n\n    resize: function() {\n      this.width = this.$refs.container.offsetWidth\n      this.height = window.innerHeight\n    },\n\n    hover: function(reaction,event) {\n      let r = 10\n      let opacity = 1\n      if(event.type == 'mouseout') {\n        r = reaction.weight\n        opacity = this.opacity\n      }\n      d3.select(event.target).transition(\"50\").attr(\"r\",r).attr(\"opacity\",opacity)\n    }\n  }\n}\n</script>\n\n<style>\n@import url('https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css');\n\n.wrapper {\n  width: 100%;\n  height: 100%;\n  //background: radial-gradient(83.17% 83.17% at 18.37% 16.83%, #20CB86 0%, #15B5B5 100%);/* Rectangle 237 */\n  //background: linear-gradient(121.09deg, #64033D 16.58%, #100530 82.74%);\n}\n\n#app {\n  min-height: 100%;\n  height: 100%\n}\n\n.hidden-0, .hidden-1, .hidden-2 {\n  fill-opacity: .2;\n  stroke-opacity: .5;\n}\n.hidden-0 {filter: url('#f0')}\n.hidden-1 {filter: url('#f1')}\n.hidden-2 {filter: url('#f2')}\n\npath {\n  fill: none;\n  stroke: black;\n}\n</style>\n"]}]}