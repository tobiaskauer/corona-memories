(function(e){function t(t){for(var n,i,a=t[0],c=t[1],u=t[2],m=0,d=[];m<a.length;m++)i=a[m],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&d.push(o[i][0]),o[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);l&&l(t);while(d.length)d.shift()();return s.push.apply(s,u||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],n=!0,a=1;a<r.length;a++){var c=r[a];0!==o[c]&&(n=!1)}n&&(s.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},o={app:0},s=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/corona-memories/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var l=c;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"034f":function(e,t,r){"use strict";r("85ec")},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",[e.newMemory.showForm?r("div",{staticClass:"formWrapper"},[r("memoryForm",{attrs:{date:e.newMemory.date,country:e.currentCountry},on:{close:function(t){return e.toggleForm(!1)}}})],1):e._e(),e.displayMemory.display?r("div",{staticClass:"memoryWrapper"},[r("memoryDisplay",{attrs:{memory:e.displayMemory.memory},on:{close:function(t){return e.showMemory(!1)}}})],1):e._e(),r("div",{staticClass:"visWrapper"},[e.cases?r("vis",{attrs:{dimensions:e.dimensions,cases:e.cases,country:e.currentCountry,memories:e.memories,dateSelector:e.newMemory.showLine,overlay:e.overlay,active:e.displayMemory.memory},on:{showForm:function(t){return e.toggleForm(t)},showMemory:e.showMemory}}):e._e()],1),r("div",{staticClass:"introWrapper"},[r("h1",[e._v("corona diaries")]),r("p",[e._v("It did not happen over night, but everything is different now. What are your memories, experiences and feelings after living in a pandemic for "),r("counter"),e._v(" days?")],1),e.countries?r("v-select",{attrs:{items:e.countries,label:"Your country",outlined:""},model:{value:e.currentCountry,callback:function(t){e.currentCountry=t},expression:"currentCountry"}}):e._e(),r("v-btn",{attrs:{color:"primary",outlined:"",block:""},on:{click:function(t){return e.showLine(!0)}}},[e._v("I have a memory")])],1)])},s=[],i=(r("c740"),r("d81d"),r("96cf"),r("1da1")),a=r("3003"),c=r("bc3a"),u=r.n(c),l=function(){return u.a.create({baseURL:"https://corona-memories-server.herokuapp.com"})},m={getCases:function(e){return l().post("getCases",e)},getCountries:function(){return l().post("getCountries")}},d={sendMemory:function(e){return l().post("sendMemory",e)},getMemories:function(e){return l().post("getMemories",e)}},f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-overlay",[r("v-card",{staticClass:"mx-auto my-12",attrs:{loading:e.loading,elevation:"2",opacity:"0",light:""}},[r("template",{slot:"progress"},[r("v-progress-linear",{attrs:{color:"deep-purple",height:"10",indeterminate:""}})],1),r("v-card-title",[e._v("Share a memory")]),e.status?r("v-card-text",[r("v-alert",{attrs:{border:"left","colored-border":"",color:"primary",elevation:"2"}},[e._v(" "+e._s(e.status)+" ")]),r("v-btn",{attrs:{block:"",color:"primary",outlined:""},on:{click:function(t){return e.close()}}},[e._v("Cool!")])],1):r("v-card-text",[r("p",[e._v("What did you lorem ipsum sed dolor sit amet?")]),r("v-form",[r("v-text-field",{attrs:{label:"Date",readonly:""},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}}),r("v-textarea",{attrs:{label:"Your Memory"},model:{value:e.memory,callback:function(t){e.memory=t},expression:"memory"}}),r("v-btn",{attrs:{block:"",color:"primary",outlined:""},on:{click:e.sendMemory}},[e._v("Send")])],1),r("div",{staticStyle:{"text-align":"center","font-size":".8em","text-decoration":"underline",cursor:"pointer"},on:{click:function(t){return e.close()}}},[e._v("Cancel")])],1)],2)],1)},h=[],y={data:function(){return{memory:"abc123",status:!1,loading:!1}},props:{country:String,date:String},methods:{sendMemory:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,r={comment:e.memory,date:new Date(e.date),country:e.country,id:null},t.prev=2,t.next=5,d.sendMemory(r);case 5:n=t.sent,console.log(n),n&&(e.loading=!1),200==n.status&&(e.status="Your memory has been recorded"),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](2),e.status=t.t0.response.data.error;case 14:case"end":return t.stop()}}),t,null,[[2,11]])})))()},close:function(){this.status=!1,this.$emit("close"),console.log(this.status)}}},p=y,v=r("2877"),w=Object(v["a"])(p,f,h,!1,null,"daf23324",null),g=w.exports,x=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-overlay",{attrs:{opacity:"0"}},[r("v-card",{staticClass:"memoryCard",attrs:{elevation:"2","min-width":"300","max-width":"500"}},[r("v-card-text",[r("span",[e._v(e._s(e.memory.date))]),r("p",[e._v(e._s(e.memory.comment))]),r("br"),r("v-btn",{attrs:{"x-small":""},on:{click:e.close}},[e._v("close")])],1)],1)],1)},b=[],M={data:function(){return{}},props:{memory:Object},asyncComputed:{reactions:function(){return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)})))()}},methods:{close:function(){this.$emit("close")}}},_=M,k=(r("f1b5"),Object(v["a"])(_,x,b,!1,null,"4dae3288",null)),C=k.exports,D=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("strong",[e._v(e._s(e.counter))])},S=[],j={data:function(){return{counter:0}},computed:{daysSinceStart:function(){var e=new Date("2020-01-22"),t=new Date;return Math.ceil((t-e)/864e5)}},mounted:function(){this.count()},methods:{count:function(){var e=this;setTimeout((function(){e.counter++,e.counter<=e.daysSinceStart&&e.count()}),5)}}},O=j,E=Object(v["a"])(O,D,S,!1,null,"1493ae47",null),F=E.exports,A=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.mounted?r("svg",{attrs:{width:e.dimensions.width,height:e.dimensions.height,"z-index":"5"}},[r("filter",{attrs:{id:"blurMe"}},[r("feGaussianBlur",{attrs:{in:"SourceGraphic",stdDeviation:"1"}})],1),r("g",{directives:[{name:"axis",rawName:"v-axis:x",value:e.scales,expression:"scales",arg:"x"}],staticClass:"axis xAxis",attrs:{transform:"translate(0,"+(e.dimensions.height-e.dimensions.top-e.dimensions.bottom+10)+")"}}),r("g",{directives:[{name:"axis",rawName:"v-axis:y",value:e.scales,expression:"scales",arg:"y"}],staticClass:"axis yAxis",attrs:{transform:"translate("+(e.dimensions.width-e.dimensions.right)+")"}}),r("path",{attrs:{d:e.caseLine,"stroke-width":"3",fill:"none",stroke:"black"}}),e.beeswarm?r("g",{staticClass:"memories",attrs:{transform:"translate(0,0)"}},[e._l(e.beeswarm,(function(t,n){return r("g",{key:n},[r("circle",{attrs:{cx:t.x,cy:t.y,opacity:e.opacity,r:t.weight,fill:"#FA5E2D",filter:e.overlay?"url(#blurMe)":""},on:{click:function(r){return e.$emit("showMemory",t)},mouseover:function(r){return e.hover(t,r)},mouseout:function(r){return e.hover(t,r)}}})])})),e._v(" "),e._l(e.lineMemories,(function(t,n){return r("g",{key:"line-"+n},[t.path?r("path",{attrs:{d:t.path,stroke:"#FA5E2D",fill:"none"}}):e._e()])}))],2):e._e(),e.dateSelector?r("g",{staticClass:"dateSelector"},[r("circle",{attrs:{r:"25",cx:"0",cy:"0",fill:"#FA5E2D",transform:"translate("+e.newMemory.circle.x+","+e.newMemory.circle.y+")"}}),e.newMemory.date?r("text",{attrs:{fill:"white","font-size":"10px",transform:"translate("+e.newMemory.circle.x+","+e.newMemory.circle.y+")","text-anchor":"middle"}},[e._v(e._s(e.shortFormatDate(e.newMemory.startDate)))]):e._e(),e.newMemory.line?r("path",{attrs:{d:e.newMemory.line,stroke:"#FA5E2D",fill:"none","stroke-width":"8"}}):e._e()]):e._e(),e.overlay?r("g",{staticClass:"overlay"},[r("rect",{attrs:{x:"0",y:"0",width:e.dimensions.width,height:e.dimensions.height,fill:"black",opacity:".5","pointer-events":"none"}}),e.currentMemory?r("g",[r("circle",{attrs:{r:"20",cx:e.currentMemory.x,cy:e.currentMemory.y,fill:"#FA5E2D"}}),r("path",{attrs:{d:e.currentMemory.connector,"stroke-width":"2",fill:"none",stroke:"#FA5E2D"}})]):e._e()]):e._e()]):e._e()},L=[],R=(r("99af"),r("4de4"),r("7db0"),r("4160"),r("159b"),r("5698")),P={data:function(){return{parseDate:R["p"]("%Y-%m-%d"),formatDate:R["n"]("%Y-%m-%d"),shortFormatDate:R["n"]("%b %d"),lineGenerator:R["i"]().curve(R["c"]).x((function(e){return e.x})).y((function(e){return e.y})),mounted:!1,mouseDown:!1,opacity:.7,forceDistance:5,linePosition:[0,0],currentMemory:null,newMemory:{startDate:null,endDate:null,show:!1,circle:{x:0,y:0},line:!1}}},props:{dimensions:Object,cases:Array,memories:Array,dateSelector:Boolean,overlay:Boolean},computed:{parsedCases:function(){var e=this;return this.cases.map((function(t){return{dateString:t.d,date:e.parseDate(t.d),value:t.v}}))},scales:function(){if(!this.parsedCases)return null;var e=[0,R["j"]([50,R["j"](this.parsedCases,(function(e){return e.value}))])],t=R["d"](this.parsedCases,(function(e){return e.date})),r=R["l"]().domain(t).range([this.dimensions.left,this.dimensions.width-this.dimensions.right]),n=R["k"]().domain(e).range([this.dimensions.height-this.dimensions.bottom-this.dimensions.top,this.dimensions.top]);return{x:r,y:n}},circleMemories:function(){var e=this;if(!this.memories&&!this.scales)return null;var t=this.memories;return t&&t.length>0&&(t=t.filter((function(e){return e.date==e.enddate})),t.forEach((function(t){t.y=e.scales.y(e.getYforDate(t.date)),t.x=e.scales.x(e.parseDate(t.date))}))),t},lineMemories:function(){var e=this;if(!this.memories&&!this.scales)return console.log(this.memories,this.scales),null;var t=this.memories;return t.length>0&&(t=t.filter((function(e){return e.date!=e.enddate})),t.forEach((function(t,r){var n=e.getLineSegment(t.date,t.enddate);n.length>0&&n.forEach((function(e){return e.y=e.y-5})),1==r&&console.log(n,e.lineGenerator(n)),t.path=e.lineGenerator(n)}))),t},beeswarm:function(){if(!this.circleMemories)return null;for(var e=R["f"](this.circleMemories).force("forceX",R["g"]((function(e){return e.x})).strength(.1)).force("forceY",R["h"]((function(e){return e.y+10})).strength(.1)).force("collide",R["e"]((function(e){return e.weight}))),t=0;t<10;++t)e.tick();return e.nodes()},caseLine:function(){var e=this;if(!this.scales)return!1;var t=this.parsedCases.map((function(t){return t.x=e.scales.x(t.date),t.y=e.scales.y(t.value),t}));return this.lineGenerator(t)}},watch:{beeswarm:function(e){var t=e.filter((function(e){return e.active}))[0];t&&(this.currentMemory=t,this.currentMemory.connector="\n        M".concat(t.x," ").concat(t.y,"\n        Q").concat(this.dimensions.width/2," ").concat(t.y,"\n        ").concat(this.dimensions.width/2," ").concat(this.dimensions.height/2))}},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.mounted=!0,document.addEventListener("mousemove",e.onMouseMove),document.addEventListener("mousedown",e.onMouseDown),document.addEventListener("mouseup",e.onMouseUp);case 4:case"end":return t.stop()}}),t)})))()},methods:{hover:function(e,t){if(!this.dateSelector){var r=10,n=1;"mouseout"==t.type&&(r=e.weight,n=this.opacity),R["m"](t.target).transition("50").attr("r",r).attr("opacity",n)}},getYforDate:function(e){var t=this.parsedCases.find((function(t){return e==t.dateString}));return t?t.value:0},getLineSegment:function(e,t){e="string"===typeof e?this.parseDate(e):e,t="string"===typeof t?this.parseDate(t):t;var r=this.parsedCases.filter((function(r){return r.date<t&&r.date>e||r.date>t&&r.date<e}));return r},onMouseMove:function(e){if(this.dateSelector){var t=this.scales.x.invert(e.clientX),r=this.formatDate(t),o=this.scales.y(this.getYforDate(r));if(this.mouseDown){var s=this.getLineSegment(this.newMemory.startDate,t);n["default"].set(this.newMemory,"line",this.lineGenerator(s))}n["default"].set(this.newMemory.circle,"x",e.clientX),n["default"].set(this.newMemory.circle,"y",o)}},onMouseDown:function(e){if(this.dateSelector){this.mouseDown=!0;var t=this.scales.x.invert(e.clientX);n["default"].set(this.newMemory,"startDate",t)}},onMouseUp:function(e){if(this.dateSelector){this.mouseDown=!1;this.scales.x.invert(e.clientX)}}},directives:{axis:function(e,t){var r=R["m"](e);switch(t.arg){case"x":r.call(R["a"](t.value.x).ticks(R["o"]).tickFormat(R["n"]("%b"))),r.selectAll(".domain").attr("stroke","none"),r.selectAll(".tick line").attr("stroke","none"),r.selectAll(".tick text").style("text-anchor","end").style("text-transform","UPPERCASE").style("opacity",.3);break;case"y":r.call(R["b"](t.value.y).tickSize(-1e3).ticks(5)),r.selectAll(".domain").attr("stroke","none"),r.selectAll(".tick line").attr("opacity",.05),r.selectAll(".tick text").attr("opacity",.3);break}}}},$=P,Y=Object(v["a"])($,A,L,!1,null,"72fd2e14",null),z=Y.exports;n["default"].use(a["a"]);var G={name:"App",components:{memoryForm:g,memoryDisplay:C,counter:F,vis:z},data:function(){return{mounted:!1,dimensions:{width:0,height:0,top:20,right:50,bottom:50,left:50},countries:null,currentCountry:"Germany",overlay:!1,displayMemory:{display:!1,current:null},newMemory:{showLine:!1,showForm:!1,date:""}}},asyncComputed:{cases:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,m.getCases({country:e.currentCountry,metric:"relative_cases"});case 2:return t.abrupt("return",t.sent.data);case 3:case"end":return t.stop()}}),t)})))()},memories:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d.getMemories({country:e.currentCountry});case 2:return t.abrupt("return",t.sent.data);case 3:case"end":return t.stop()}}),t)})))()}},created:function(){window.addEventListener("resize",this.resize)},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,m.getCountries();case 2:e.countries=t.sent.data.map((function(e){return e.country})),e.$nextTick((function(){e.resize(),e.mounted=!0}));case 4:case"end":return t.stop()}}),t)})))()},methods:{resize:function(){this.dimensions.width=window.innerWidth,this.dimensions.height=window.innerHeight},showMemory:function(e){e?(n["default"].set(this.memories[this.memories.findIndex((function(t){return t.id==e.id}))],"active",!0),n["default"].set(this.displayMemory,"memory",e),n["default"].set(this.displayMemory,"display",!0),this.overlay=!0):(n["default"].set(this.displayMemory,"display",!1),n["default"].set(this.memories[this.memories.findIndex((function(e){return e.active}))],"active",!1),this.overlay=!1)},showLine:function(e){n["default"].set(this.newMemory,"showLine",e)},toggleForm:function(e){e?(n["default"].set(this.newMemory,"date",e),n["default"].set(this.newMemory,"showLine",!1),n["default"].set(this.newMemory,"showForm",!0),this.overlay=!0):(n["default"].set(this.newMemory,"showForm",!1),this.overlay=!1)}}},W=G,T=(r("034f"),Object(v["a"])(W,o,s,!1,null,null,null)),X=T.exports,I=r("ce5b"),U=r.n(I);r("bf40");n["default"].use(U.a);var B={theme:{themes:{light:{primary:"#FA5E2D",secondary:"#b0bec5",anchor:"#8c9eff"},dark:!1}}},J=new U.a(B);n["default"].config.productionTip=!1,new n["default"]({vuetify:J,render:function(e){return e(X)}}).$mount("#app")},"85ec":function(e,t,r){},e04f:function(e,t,r){},f1b5:function(e,t,r){"use strict";r("e04f")}});
//# sourceMappingURL=app.6e7eac33.js.map