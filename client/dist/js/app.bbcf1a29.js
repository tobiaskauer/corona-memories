(function(t){function e(e){for(var n,i,o=e[0],c=e[1],u=e[2],d=0,m=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&m.push(a[i][0]),a[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);l&&l(e);while(m.length)m.shift()();return s.push.apply(s,u||[]),r()}function r(){for(var t,e=0;e<s.length;e++){for(var r=s[e],n=!0,o=1;o<r.length;o++){var c=r[o];0!==a[c]&&(n=!1)}n&&(s.splice(e--,1),t=i(i.s=r[0]))}return t}var n={},a={app:0},s=[];function i(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=n,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;s.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"166a":function(t,e,r){"use strict";r("7600")},"1bf4":function(t,e,r){},2843:function(t,e,r){"use strict";r("53b3")},"53b3":function(t,e,r){},"56d7":function(t,e,r){"use strict";r.r(e);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),a=r("8c4f"),s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"app"},[r("router-view")],1)},i=[],o=r("bc3a"),c=r.n(o),u=function(){return c.a.create({baseURL:"https://coroname.uber.space:40980"})},l={sendInteraction:function(t){return console.log(t),u().post("sendInteraction",t)}},d=r("e1bd"),m={name:"App",components:{},data:function(){return{}},watch:{},created:function(){window.addEventListener("resize",this.resize),this.$store.dispatch("setCountries"),this.$store.dispatch("setCurrentCountry","World"),this.$store.commit("setSession",Object(d["a"])())},mounted:function(){var t=this;l.sendInteraction({session:this.$store.state.session,event:"sessionStart"}),this.$nextTick((function(){t.resize()}))},methods:{resize:function(){this.$store.dispatch("setDimensions",{width:window.innerWidth,height:window.innerHeight})}}},h=m,f=r("2877"),p=Object(f["a"])(h,s,i,!1,null,"1004a50a",null),g=p.exports,v=r("ce5b"),y=r.n(v);r("bf40"),r("5363");n["default"].use(y.a);var x={icons:{iconfont:"mdi"},theme:{themes:{light:{primary:"#FA5E2D",secondary:"#b0bec5",anchor:"#8c9eff"},dark:!1}}},b=new y.a(x),w=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-app",[r("v-container",[r("v-data-table",{staticClass:"elevation-2",attrs:{headers:t.headers,items:t.memories,"items-per-page":25,"sort-by":"updatedAT","sort-desc":!0,dense:""},scopedSlots:t._u([{key:"top",fn:function(){return[r("v-toolbar",{attrs:{flat:""}},[r("v-toolbar-title",[t._v("Review Memories")]),r("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),r("v-spacer"),t.status?r("v-alert",{attrs:{type:"success",dense:""}},[t._v(t._s(t.status))]):t._e(),r("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[r("v-card",[r("v-card-title",[t._v("Are you sure you want to re-approve this item?")]),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.closeDialog}},[t._v("Cancel")]),r("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.approve}},[t._v("OK")]),r("v-spacer")],1)],1)],1)],1)]},proxy:!0},{key:"item.updatedAT",fn:function(e){var r=e.item;return[t._v(" "+t._s(t.getDate(r.updatedAT))+" ")]}},{key:"item.reapprove",fn:function(e){var n=e.item;return[r("v-btn",{attrs:{icon:""},on:{click:function(e){return t.openDialog(n)}}},[r("v-icon",{attrs:{small:"",color:"black"}},[t._v(" mdi-flag-remove ")])],1)]}},{key:"no-data",fn:function(){return[r("v-btn",{attrs:{color:"primary",click:"initialize"}},[t._v(" Reset ")])]},proxy:!0}])})],1)],1)},k=[],_=(r("c740"),r("d81d"),r("96cf"),r("1da1")),M={sendMemory:function(t){return u().post("sendMemory",t)},getMemories:function(t){return u().post("getMemories",t)},upvoteMemory:function(t){return u().post("upvoteMemory",t)},flagMemory:function(t){return console.log("Service: ",t),u().post("flagMemory",t)}},D=r("3003");n["default"].use(D["a"]);var C={data:function(){return{headers:["id","updatedAT","comment","reapprove"].map((function(t){return{text:t,value:t}})),memories:[],counter:0,dialog:!1,deleteIndex:-1,status:null}},asyncComputed:{asyncMemories:function(){return Object(_["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,M.getMemories({attributes:["id","updatedAT","comment"],flagged:!0});case 2:return t.abrupt("return",t.sent.data);case 3:case"end":return t.stop()}}),t)})))()}},methods:{openDialog:function(t){this.dialog=!0,this.deleteIndex=t.id},closeDialog:function(){var t=this;this.dialog=!1,this.$nextTick((function(){t.editedIndex=-1}))},approve:function(){var t=this;return Object(_["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:try{M.flagMemory({id:t.deleteIndex,flagged:!1}).then((function(e){200==e.status&&(n["default"].delete(t.memories,t.memories.findIndex((function(e){return e.id==t.deleteIndex}))),t.status="Item ".concat(t.deleteIndex," was successfully re-approved."),t.closeDialog())}))}catch(r){console.log(r)}case 1:case"end":return e.stop()}}),e)})))()},getDate:function(t){var e=new Date(t),r=e.getFullYear()+"/"+e.getMonth()+"/"+e.getDay();return r}},watch:{asyncMemories:function(t){this.memories=t}}},S=C,$=Object(f["a"])(S,w,k,!1,null,"4b6e3650",null),A=$.exports,O=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-app",[t.cases&&t.memories&&t.countries&&t.mounted?[r("div",{staticClass:"drawerToggle"},[r("v-btn",{staticStyle:{"background-color":"white"},attrs:{dark:"",large:"",icon:""},on:{click:function(e){t.showSidebar=!t.showSidebar}}},[r("v-icon",{staticStyle:{"margin-left":"20px"},attrs:{small:"",color:"#FA5E2D"}},[t.showSidebar?[t._v(" mdi-chevron-left ")]:[t._v(" mdi-chevron-right ")]],2)],1)],1),r("Scrollama",{staticClass:"scrollama",attrs:{progress:!0},on:{"step-enter":t.stepEnterHandler,"step-progress":t.stepProgressHandler}},[r("div",{staticClass:"visWrapper",attrs:{slot:"graphic"},slot:"graphic"},[r("vis",{attrs:{progress:t.progress,newMemory:t.newMemory},on:{pickDate:function(e){return t.pickDate(e)}}})],1),r("div",{staticClass:"introWrapper",class:{hidden:!t.showSidebar},attrs:{"data-step":"1"}},[r("h1",[t._v("corona"),r("br"),r("span",[t._v("memories")])]),r("p",{staticClass:"larger"},[t._v(" Numbers alone can not stories do not tell stories. You can.")]),r("p",[t._v("Since the start of the pandemic "),r("strong",[t._v("about "),r("counter"),t._v(" days")],1),t._v(" ago, we are confronted with charts about new cases or even deaths. What are the human stories behind the numbers?")]),r("p",{staticClass:"smaller"},[t._v("The research is conducted by Tobias Kauer (University of Edinburgh), Benjamin Bach (University of Edinburgh), and Marian Dörk (Potsdam University of Applied Sciences). It has been granted approval by the ethics committee. By clicking the button, you indicate that you are a speaker of English and at least 18 years old. You have read the "),r("a",{attrs:{href:"#"}},[t._v("information letter")]),t._v(" and you voluntarily agree to participate, and understand you can stop your participation at any time. You agree that your anonymous data may be kept permanently in Edinburgh University archived and may be used by qualified researchers for teaching and research purposes.")]),r("v-btn",{attrs:{color:"primary",outlined:""},on:{click:t.giveConsent}},[r("v-icon",{attrs:{small:""}},[t._v("mdi-check-circle")]),t._v(" I agree, show me ")],1)],1),r("div",{staticClass:"animatorWrapper",attrs:{"data-step":"2"}}),t.consent?r("div",{staticClass:"explorationWrapper",class:{hidden:!t.showSidebar},attrs:{id:"progressTarget","data-step":"3"}},[r("p",[r("strong",[t._v("Click the bubbles to read people’s stories.")]),r("br"),t._v("Select countries or hashtags to filter.")]),r("v-select",{attrs:{items:t.countries,label:"Your country",outlined:""},model:{value:t.currentCountry,callback:function(e){t.currentCountry=e},expression:"currentCountry"}}),t.hashtags?r("p",{staticClass:"hashtags"},t._l(t.hashtags.filter((function(t,e){return e<10})).sort((function(t,e){return t.tag.localeCompare(e.tag)})),(function(e,n){return r("v-chip",{key:"hashtag-"+n,style:{fontSize:e.size+"px",margin:"2px"},attrs:{small:"",color:"primary",outlined:t.activeHashtag!=e.tag},on:{click:function(r){t.activeHashtag=e.tag}}},[t._v(t._s(e.tag)+" ")])})),1):t._e()],1):t._e(),t.consent?r("div",{staticClass:"formWrapper",attrs:{id:"addTarget","data-step":"4"}},[t.newMemory.showForm?r("memoryForm",{attrs:{date:t.newMemory.date,country:t.currentCountry,countries:t.countries,hashtags:t.hashtags},on:{pickDate:function(e){return t.pickDate(e)},close:function(e){return t.toggleForm(!1)}}}):t._e()],1):t._e()]),t.consent&&t.currentStepId>1?r("div",{staticClass:"callToActionWrapper"},[r("v-btn",{attrs:{color:"primary",outlined:"",elevation:"2"},on:{click:t.toggleForm}},[t.newMemory.showForm?[r("v-icon",{attrs:{small:""}},[t._v("mdi-close-circle-outline")]),t._v("Stop adding ")]:[r("v-icon",{attrs:{small:""}},[t._v("mdi-tooltip-plus-outline")]),t._v("Add your story ")]],2)],1):t._e()]:[r("v-card",{staticClass:"d-flex justify-center mb-6",staticStyle:{"margin-top":"100px"},attrs:{color:"rgb(255, 0, 0, 0.0)",elevation:"0"}},[r("v-progress-circular",{attrs:{size:300,indeterminate:"",color:"primary"}},[t._v("Loading ..."),r("br"),t._v("try refresing?")])],1)]],2)},E=[],j=(r("5abe"),r("a57f")),H=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-card",{staticClass:"mx-auto",attrs:{elevation:"2","max-width":"500","min-width":"400",id:"top",light:""}},[t.returnID?r("v-card-text",{staticStyle:{"padding-top":"0px"}},[r("v-card-title",{staticClass:"ma-0",staticStyle:{"padding-left":"0"}},[t._v(" Your story has been recorded. "),r("v-spacer"),r("v-btn",{attrs:{icon:""},on:{click:t.close}},[r("v-icon",{attrs:{center:"",color:"lightgrey",small:""}},[t._v("mdi-close-circle")])],1)],1),r("p",[t._v(" If you have a minute and want to help our research, please consider filling out our "),r("a",{attrs:{href:"https://docs.google.com/forms/d/e/1FAIpQLSfydTg7ZpZG21s9in4M-mM_8BxA5mZm73K2p5KDshaAcRipgA/viewform?entry.62570228="+t.returnID,target:"_blank"}},[t._v("survey")]),t._v(". ")]),r("v-btn",{attrs:{small:"",outlined:"",color:"primary",block:"",href:"https://docs.google.com/forms/d/e/1FAIpQLSfydTg7ZpZG21s9in4M-mM_8BxA5mZm73K2p5KDshaAcRipgA/viewform?entry.62570228="+t.returnID,target:"_blank"}},[t._v("Fill out Survey")]),r("v-btn",{staticStyle:{"margin-top":"10px"},attrs:{small:"",outlined:"",color:"primary",block:""},on:{click:t.blankify}},[t._v("Add another story first")])],1):r("v-card-text",{staticStyle:{"padding-top":"0px"}},[r("v-card-title",{staticClass:"ma-0",staticStyle:{"padding-left":"0"}},[t._v(" Add your story to the chart "),r("v-spacer"),r("v-btn",{attrs:{icon:""},on:{click:t.close}},[r("v-icon",{attrs:{center:"",color:"lightgrey",small:""}},[t._v("mdi-close-circle")])],1)],1),r("v-form",{staticStyle:{padding:"10px 0"},model:{value:t.isFormValid,callback:function(e){t.isFormValid=e},expression:"isFormValid"}},[r("v-textarea",{staticClass:"ma-0 pa-0",attrs:{dense:"",outlined:"",rules:t.rules.notEmpty,label:"Your Story"},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}}),t.hashtags&&t.showHashtags>0?r("p",{staticClass:"hashtags"},[t._v(" Add these (or other) hashtags"),r("br"),t._l(t.hashtags.filter((function(e,r){return r<t.showHashtags})).sort((function(t,e){return t.tag.localeCompare(e.tag)})),(function(e,n){return r("v-chip",{key:"hashtag-"+n,style:{margin:"2px"},attrs:{small:"",color:"primary",outlined:!t.comment.includes(e.tag)},on:{click:function(r){return t.addTag(e.tag)}}},[t._v(t._s(e.tag)+" ")])})),r("a",{on:{click:function(e){t.showHashtags=20}}},[t._v("show more")])],2):t._e(),r("v-select",{attrs:{items:t.countries,dense:"",label:"Your country",outlined:""},model:{value:t.currentCountry,callback:function(e){t.currentCountry=e},expression:"currentCountry"}}),this.exactDate?[r("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,a=e.attrs;return[r("v-text-field",t._g(t._b({staticClass:"ma-0",attrs:{rules:t.rules.notEmpty,label:"Pick a date","append-icon":"mdi-calendar",outlined:"",readonly:"",dense:""},model:{value:t.displayDate,callback:function(e){t.displayDate=e},expression:"displayDate"}},"v-text-field",a,!1),n))]}}]),model:{value:t.datepicker,callback:function(e){t.datepicker=e},expression:"datepicker"}},[r("v-date-picker",{on:{input:function(e){t.datepicker=!1}},model:{value:t.displayDate,callback:function(e){t.displayDate=e},expression:"displayDate"}})],1)]:[r("v-text-field",{staticClass:"ma-0",attrs:{"v-model":t.getRoughDate(t.displayDate),label:"Date",outlined:"",dense:"",readonly:""}})]],2),r("v-btn",{staticStyle:{margin:"10px 0"},attrs:{disabled:!t.isFormValid,block:"",color:"primary",outlined:""},on:{click:t.sendMemory}},[t._v("Send")])],1)],1)},F=[],T={data:function(){return{panel:null,comment:"",name:"",currentCountry:null,datepicker:!1,showHashtags:0,returnID:null,displayDate:null,isFormValid:!1,rules:{notEmpty:[function(t){return!!t||"Please enter a memory!"}]}}},props:{country:String,countries:Array,hashtags:Array,date:Object},computed:{exactDate:{set:function(){this.$store.commit("toggleNewMemoryExactDate")},get:function(){return this.$store.state.newMemory.exactDate}}},mounted:function(){this.currentCountry=this.country},methods:{addTag:function(t){this.comment=this.comment+" "+t},getRoughDate:function(t){console.log(t);var e=new Date(t),r="Late";e.getDate()<=20&&(r="Mid"),e.getDate()<=10&&(r=" Early");var n=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()];return r+" "+n},sendMemory:function(){var t=this;return Object(_["a"])(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,r={comment:t.comment,date:new Date(t.displayDate),country:t.currentCountry,exact:t.date.exact},e.prev=2,e.next=5,M.sendMemory(r);case 5:n=e.sent,200==n.status&&(t.returnID=n.data.id,t.$vuetify.goTo("#top",{duration:500})),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](2),t.status=e.t0.response.data.error;case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))()},close:function(){this.returnID=null,this.$emit("close")},blankify:function(){this.returnID=null,this.comment=""}},watch:{comment:function(t){t.length>2&&this.showHashtags<10&&(this.showHashtags=10)},date:{immediate:!0,deep:!0,handler:function(){this.displayDate=this.date.string,this.exactDate=this.date.exact}},displayDate:function(){this.$emit("pickDate",{string:this.displayDate,exact:this.exactDate})},exactDate:function(){this.$emit("pickDate",{string:this.displayDate,exact:this.exactDate})}}},I=T,R=(r("7619"),Object(f["a"])(I,H,F,!1,null,"8cb1ca7c",null)),B=R.exports,P=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("span",[t._v(t._s(t.counter))])},L=[],z={data:function(){return{counter:0}},computed:{daysSinceStart:function(){var t=new Date("2020-01-22"),e=new Date;return Math.ceil((e-t)/864e5)}},mounted:function(){this.count()},methods:{count:function(){var t=this;setTimeout((function(){t.counter++,t.counter<=t.daysSinceStart&&t.count()}),5)}}},W=z,Y=Object(f["a"])(W,P,L,!1,null,"5c9d5361",null),N=Y.exports,U=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.scales.x&&t.cases&&t.mounted?r("svg",{attrs:{width:t.dimensions.width,height:t.dimensions.height}},[r("g",{directives:[{name:"axis",rawName:"v-axis:x",value:t.scales,expression:"scales",arg:"x"}],staticClass:"axis xAxis",attrs:{transform:"translate(0,"+(t.dimensions.height-t.dimensions.top-t.dimensions.bottom+10)+")"}}),r("g",{directives:[{name:"axis",rawName:"v-axis:y",value:t.scales,expression:"scales",arg:"y"}],staticClass:"axis yAxis",attrs:{transform:"translate("+(t.dimensions.width-t.dimensions.right)+")"}}),r("path",{attrs:{d:t.caseLine,"stroke-width":"3","stroke-linejoin":"round",fill:"none",stroke:"black"}}),t.beeswarm?r("g",{staticClass:"beeswarm"},[r("g",{staticClass:"circles"},t._l(t.beeswarm.filter((function(e,r){return r<t.progress&&e.isMemory})),(function(e){return r("path",{key:"circle-"+e.id,class:{inactive:t.activeHashtag&&t.activeHashtag!=e.hashtag},attrs:{d:e.d,transform:"translate("+e.x+","+e.y+")",id:"circle-"+e.id,opacity:t.opacity},on:{click:function(r){return t.click(e.id)},mouseover:function(r){return t.hover(e,r)},mouseout:function(r){return t.hover(e,r)}}})})),0),t.hashtags&&t.activeMemories.length<1&&!t.activeHashtag&&t.progress>t.beeswarm.filter((function(t){return t.isMemory})).length-10?r("g",{staticClass:"hashtags"},t._l(t.hashtags,(function(e,n){return r("g",{key:"label-"+n},[r("line",{attrs:{stroke:"#FA5E2D","stroke-width":".5",x1:e.source.x,y1:e.source.y,x2:e.target.x,y2:e.target.y+1}}),r("text",{attrs:{fill:"#FA5E2D",x:e.target.x,"text-anchor":e.target.anchor,y:e.target.y},on:{click:function(r){return t.click(e.target.id)}}},[t._v(t._s(e.target.text))])])})),0):t._e()]):t._e(),t.activeMemories&&t.progress>t.beeswarm.filter((function(t){return t.isMemory})).length-10?r("g",t._l(t.memoryLinks,(function(e,n){return r("g",{key:"card-"+n},[r("line",{attrs:{stroke:"#FA5E2D",x1:e.source.x,y1:e.source.y,x2:e.target.x,y2:e.target.y}}),r("foreignObject",{attrs:{width:t.memoryBox.width+4,height:t.memoryBox.height+4,x:e.target.x-t.memoryBox.width/2,y:e.target.y-t.memoryBox.height/2,requiredFeatures:"http://www.w3.org/TR/SVG11/feature#Extensibility"}},[r("memoryCard",{attrs:{dimensions:t.memoryBox,memory:e.target.memory}})],1)],1)})),0):t._e(),t.newMemory.showForm?r("Datepicker",{attrs:{date:t.newMemory.date}}):t._e()],1):t._e()},J=[],K=(r("99af"),r("4160"),r("a9e3"),r("18a5"),r("159b"),r("2909")),G=r("5698"),V=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("g",{staticClass:"datePicker",attrs:{transform:"translate("+t.x+",0)"},on:{mousedown:t.mouseDown,mouseup:t.mouseUp}},[r("line",{attrs:{y1:"0",y2:t.height,x1:"0",x2:"0",stroke:"#FA5E2D","stroke-width":"2px","stroke-dasharray":"0"}}),r("circle",{attrs:{r:"40",cx:"0",cy:t.y,fill:"#FA5E2D"}}),r("text",{attrs:{x:"0","text-anchor":"middle",y:t.y}},[t._v(t._s(t.displayDate))])])},Z=[],X=(r("7db0"),r("c7cd"),{data:function(){return{formatDate:G["o"]("%Y-%m-%d"),parseDate:G["q"]("%Y-%m-%d"),height:window.innerHeight,x:-100,y:-100,displayDate:null,fixed:!1}},props:{date:Object},computed:{scales:function(){return this.$store.state.scales},cases:function(){return this.$store.state.cases}},mounted:function(){document.addEventListener("mousemove",this.onMouseMove)},watch:{date:{deep:!0,immediate:!0,handler:function(t){t.string!=this.displayDate&&(this.displayDate=t.string,this.x=this.scales.x(this.parseDate(t.string)))}}},methods:{onMouseMove:function(t){if(!this.fixed&&t.clientX>this.scales.x.range()[0]&&t.clientX<this.scales.x.range()[1]){var e=this.scales.x.invert(t.clientX),r=this.formatDate(e);this.x=t.clientX,this.y=this.scales.y(this.getLineElement(e).value),this.displayDate=r}},mouseUp:function(){this.fixed=!0,this.$parent.$emit("pickDate",{string:this.displayDate,exact:this.date.exact})},mouseDown:function(){this.fixed=!1},getLineElement:function(t){var e="string"==typeof t?t:this.formatDate(t),r=this.cases.find((function(t){return t.dateString==e}));return r||null},getRoughDate:function(t){if(!t)return null;var e="Late";t.getDate()<=20&&(e="Mid"),t.getDate()<=10&&(e="Early");var r=["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()];return e+" "+r}}}),q=X,Q=(r("166a"),Object(f["a"])(q,V,Z,!1,null,"5a24f326",null)),tt=Q.exports,et=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.memory?r("v-card",{staticClass:"memoryCard overflow-y-auto",attrs:{elevation:"2",width:t.dimensions.width,"max-height":t.dimensions.height}},[r("div",[r("v-btn",{staticStyle:{position:"absolute",right:"5px",top:"0px"},attrs:{icon:""},on:{click:t.close}},[r("v-icon",{attrs:{small:"",color:"black"}},[t._v("mdi-close-circle")])],1)],1),r("v-card-text",[r("v-row",{attrs:{dense:""}},[r("v-col",[r("p",{staticClass:"topBar"},[r("v-btn",{attrs:{"x-small":"",fab:"",outlined:"",center:""},on:{click:function(e){return t.upvote(e)},mouseover:function(e){return t.mouseOver(!0)},mouseout:function(e){return t.mouseOver(!1)}}},[t._v(" "+t._s(t.weight)),r("br"),r("v-icon",{attrs:{color:"black",small:""}},[t._v("mdi-heart")])],1),t._v(" "+t._s(t.memory.dateString)+" ")],1),r("p",{staticClass:"comment"},[t._v(t._s(t.memory.comment))]),t.status?[t._v(" "+t._s(t.status)+" ")]:[r("v-btn",{attrs:{outlined:"","x-small":""},on:{click:t.report}},[r("v-icon",{attrs:{"x-small":""}},[t._v("mdi-flag")]),t._v(" Report ")],1)]],2)],1)],1)],1):t._e()},rt=[],nt={data:function(){return{status:null,weight:null}},props:{memory:Object,dimensions:Object},created:function(){this.weight=this.memory.weight},computed:{localMemory:function(){return this.memory?this.memory:null}},methods:{close:function(){this.$store.commit("setActiveMemories",this.memory.id)},mouseOver:function(t){this.weight=t?"+1":this.localMemory.weight},upvote:function(){var t=this;return Object(_["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:try{M.upvoteMemory({id:t.memory.id}).then((function(e){200==e.status&&(t.localMemory.weight=e.data.weight)}))}catch(r){console.log(r)}case 1:case"end":return e.stop()}}),e)})))()},report:function(){var t=this;return Object(_["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:try{M.flagMemory({id:t.memory.id,flagged:!0}).then((function(e){200==e.status&&(t.status="Thank you. We will not show this story until we reviewed it.",setTimeout((function(){t.close()}),2e3))}))}catch(r){console.log(r)}case 1:case"end":return e.stop()}}),e)})))()}}},at=nt,st=(r("63d0"),Object(f["a"])(at,et,rt,!1,null,"12969e2f",null)),it=st.exports,ot={components:{Datepicker:tt,memoryCard:it},data:function(){return{mounted:!1,visibleHashtags:10,opacity:.8,lineGenerator:G["j"]().x((function(t){return t.x})).y((function(t){return t.y})),memoryBox:{width:300,height:150}}},props:{progress:Number,newMemory:Object},computed:{dimensions:function(){return this.$store.state.dimensions},cases:function(){return this.$store.state.cases},beeswarm:function(){return this.$store.getters.beeswarm},activeHashtag:function(){return this.$store.state.activeHashtag},scales:function(){return this.$store.state.scales},activeMemories:function(){return this.$store.getters.activeMemories},memoryLinks:function(){var t=this;if(!this.activeMemories)return null;var e=[],r=[];this.activeMemories.forEach((function(n){e.push({type:"circle",fx:n.x,fy:n.y}),e.push({type:"box",x:n.x-t.memoryBox.width/2,y:n.y-t.memoryBox.height/2,memory:n}),r.push({source:e.length-2,target:e.length-1})}));for(var n=G["g"](e).force("charge",G["f"]().strength(1)).force("link",G["e"]().links(r)).force("collide",G["d"](100)),a=0;a<=10;a++)n.tick();return r.forEach((function(e){e.target.y<t.memoryBox.height/2&&(e.target.y=t.memoryBox.height/2),e.target.x<t.memoryBox.width/2&&(e.target.x=t.memoryBox.width/2)})),r},caseLine:function(){var t=this;if(!this.scales||!this.cases)return!1;var e=this.cases.map((function(e){return e.x=t.scales.x(e.date),e.y=t.scales.y(e.value),e}));return this.lineGenerator(e)},hashtags:function(){var t=this;if(!this.beeswarm)return null;var e=[],r=[],n=Object(K["a"])(this.beeswarm).sort((function(t,e){return e.weight-t.weight}));n.forEach((function(n){e.push({type:"circle",fx:n.x,fy:n.y}),n.hashtag&&r.length<t.visibleHashtags&&(e.push({type:"label",x:n.x,y:n.y,text:n.hashtag,id:n.id}),r.push({source:e.length-2,target:e.length-1}))}));for(var a=G["g"](e).force("charge",G["f"]().strength(1)).force("link",G["e"]().links(r)).force("collide",G["d"](17)),s=0;s<=10;s++)a.tick();return r.forEach((function(t){t.target.anchor=t.target.x>=t.source.x?"start":"end"})),r}},watch:{},mounted:function(){this.mounted=!0},methods:{hover:function(t,e){if(!this.datePicker){var r="mouseover"==e.type?2:1;G["n"](e.target).transition("50").attr("transform","translate(".concat(t.x,",").concat(t.y,") scale(").concat(r,")"))}},click:function(t){l.sendInteraction({session:this.$store.state.session,event:"openMemory",element:t}),this.$store.commit("setActiveMemories",t)}},directives:{axis:function(t,e){var r=G["n"](t);switch(e.arg){case"x":r.call(G["a"](e.value.x).ticks(G["p"]).tickFormat(G["o"]("%b"))),r.selectAll(".domain").attr("stroke","none"),r.selectAll(".tick line").attr("stroke","none"),r.selectAll(".tick text").style("text-anchor","end").style("text-transform","UPPERCASE").style("opacity",.3);break;case"y":r.call(G["b"](e.value.y).tickSize(-1e3).ticks(5)),r.selectAll(".domain").attr("stroke","none"),r.selectAll(".tick line").attr("opacity",.05),r.selectAll(".tick text").attr("opacity",.3);break}}}},ct=ot,ut=(r("2843"),Object(f["a"])(ct,U,J,!1,null,"44cf3dc0",null)),lt=ut.exports,dt={name:"App",components:{Scrollama:j["a"],memoryForm:B,counter:N,vis:lt},data:function(){return{showSidebar:!0,mounted:!1,consent:!1,currentStepId:0,progress:0,newMemory:{showForm:!1,date:{string:"",exact:!0}}}},computed:{cases:function(){return this.$store.state.cases},memories:function(){return this.$store.state.memories},countries:function(){return this.$store.state.countries},hashtags:function(){return this.$store.state.hashtags},currentCountry:{get:function(){return this.$store.state.currentCountry},set:function(t){this.$store.dispatch("setCurrentCountry",t)}},activeHashtag:{get:function(){return this.$store.state.activeHashtag},set:function(t){t==this.activeHashtag?this.$store.commit("setActiveHashtag",null):this.$store.commit("setActiveHashtag",t)}}},watch:{showSidebar:function(t){t?this.$store.dispatch("setDimensions",{left:400}):this.$store.dispatch("setDimensions",{left:30})}},mounted:function(){this.mounted=!0},methods:{giveConsent:function(){var t=this;l.sendInteraction({session:this.$store.state.session,event:"click",element:"consent"}),this.consent=!0,this.$nextTick((function(){t.$vuetify.goTo("#progressTarget",{duration:2e3})}))},stepEnterHandler:function(t){var e=t.element;t.direction;switch(e.className){case"introWrapper":this.progress=0;break}this.currentStepId=e.dataset.step},stepProgressHandler:function(t){var e=t.element,r=t.progress;if("animatorWrapper"==e.className&&this.consent){var n=Math.ceil(r*this.memories.length);this.progress=n}},filterMemories:function(t){this.activeHashtag!=t?this.activeHashtag=t:this.activeHashtag=null,console.log("foo"),l.sendInteraction({session:this.$store.state.session,event:"filter",element:this.activeHashtag})},toggleForm:function(){var t=this;this.newMemory.showForm?(n["default"].set(this.newMemory,"showForm",!1),this.$vuetify.goTo("#progressTarget",{duration:500})):(n["default"].set(this.newMemory,"showForm",!0),this.$nextTick((function(){t.$vuetify.goTo("#addTarget",{duration:2e3})})))},pickDate:function(t){n["default"].set(this.newMemory.date,"string",t.string),n["default"].set(this.newMemory.date,"exact",t.exact)}}},mt=dt,ht=(r("7296"),r("67ad"),Object(f["a"])(mt,O,E,!1,null,"ff5e8e4a",null)),ft=ht.exports,pt=(r("4de4"),r("0481"),r("caad"),r("13d5"),r("a434"),r("4069"),r("b64b"),r("ac1f"),r("2532"),r("466d"),r("5319"),r("2f62")),gt={getCases:function(t){return u().post("getCases",t)},getCountries:function(){return u().post("getCountries")}};n["default"].use(pt["a"]);var vt=G["q"]("%Y-%m-%d"),yt=new pt["a"].Store({state:{session:"",countries:[],currentCountry:"",currentMetric:"relative_cases",cases:[],memories:[],activeMemories:[],hashtags:[],activeHashtag:"",dimensions:{width:0,height:0,top:100,right:40,bottom:50,left:400},scales:{},newMemory:{exactDate:!0}},getters:{activeMemories:function(t){return t.memories.filter((function(e){return t.activeMemories.includes(e.id)}))},beeswarm:function(t){var e=t.cases.map((function(t){return{fx:t.x,fy:t.y,isMemory:!1,radius:4}})),r=G["l"]().domain(G["c"](t.memories,(function(t){return t.weight}))).range([2,6]),n=t.memories.map((function(e){var n=t.cases.findIndex((function(t){return t.dateString==e.dateString}));e.value=-1!==n?t.cases[n].value:0,e.isMemory=!0,e.x=t.scales.x(e.date),e.y=t.scales.y(e.value),e.radius=r(e.weight),e.scale=1;var a=function(t){return t+(Math.random()*e.radius/2-e.radius/4)},s=a(e.radius),i=a(e.radius),o=a(e.radius),c=a(e.radius);return e.d="\n          M 0 ".concat(-s,"\n          C ").concat(i/2," ").concat(-s," ").concat(i," ").concat(-i/2," ").concat(i," ",0,"\n          C ").concat(i," ").concat(o/2," ").concat(o/2," ").concat(o," ",0," ").concat(o,"\n          C ").concat(-c/2," ").concat(o," ").concat(-c," ").concat(c/2," ").concat(-c," ",0,"\n          C ").concat(-c," ").concat(-s/2," ").concat(-s/2," ").concat(-s," ",0," ").concat(-s,"\n        ").replace(/(\r\n|\n|\r)/gm,""),e}));if(n.length>0){for(var a=n.concat(e),s=G["g"](a).force("forceX",G["h"]((function(t){return t.x})).strength(.1)).force("forceY",G["i"]((function(t){return t.y})).strength(.1)).force("collide",G["d"]((function(t){return t.radius+t.radius/4}))),i=0;i<=20;i++)s.tick();return a}return[]}},mutations:{setSession:function(t,e){t.session=e},setCases:function(t,e){t.cases=e},setCurrentCountry:function(t,e){t.currentCountry=e},setCountries:function(t,e){t.countries=e},setActiveHashtag:function(t,e){t.activeHashtag=e},setActiveMemories:function(t,e){var r=t.activeMemories.findIndex((function(t){return t==e}));-1===r?t.activeMemories.push(e):t.activeMemories.splice(r,1)},setMemories:function(t,e){t.memories=e.map((function(t){var e=t.comment.match(/#[a-z]+/gi);return t.hashtag=e?e[0]:null,t.date=vt(t.dateString),t}))},setDimensions:function(t,e){e.width&&(t.dimensions.width=e.width),e.height&&(t.dimensions.height=e.height),e.left&&(t.dimensions.left=e.left)},setScales:function(t){var e=t.dimensions,r=[0,G["k"]([50,G["k"](t.cases,(function(t){return t.value}))])],n=G["c"](t.cases,(function(t){return t.date})),a=G["m"]().domain(n).range([e.left,e.width-e.right]),s=G["l"]().domain(r).range([e.height-e.bottom-e.top,e.top]);t.scales={x:a,y:s}},toggleNewMemoryExactDate:function(t){t.newMemory.exactDate=!t.newMemory.exactDate},setHashtags:function(t,e){var r=e.map((function(t){return t.comment.match(/#[a-z]+/gi)})).flat().filter((function(t){return t})),n=r.reduce((function(t,e){return t[e]=(t[e]||0)+1,t}),{}),a=Object.keys(n).map((function(t){return{tag:t,occurences:n[t]}})).sort((function(t,e){return e.occurences-t.occurences})),s=G["l"]().domain(G["c"](a,(function(t){return t.occurences}))).range([5,15]);a.forEach((function(t){return t.size=s(t.occurences)})),t.hashtags=a}},actions:{setCases:function(t){return Object(_["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,gt.getCases({country:t.state.currentCountry,metric:t.state.currentMetric});case 2:r=e.sent.data.map((function(t){return{dateString:t.d,date:vt(t.d),value:t.v}})),t.commit("setCases",r),t.commit("setScales");case 5:case"end":return e.stop()}}),e)})))()},setMemories:function(t){return Object(_["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,M.getMemories({attributes:[["date","dateString"],"exactDate","comment","weight","id"],country:t.state.currentCountry,flagged:!1});case 2:r=e.sent.data,t.commit("setMemories",r),t.commit("setHashtags",r);case 5:case"end":return e.stop()}}),e)})))()},setCountries:function(t){return Object(_["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=["World","Germany","France","Italy","United States","United Kingdom","Switzerland"],t.commit("setCountries",r);case 2:case"end":return e.stop()}}),e)})))()},setCurrentCountry:function(t,e){t.commit("setCurrentCountry",e),t.dispatch("setCases"),t.dispatch("setMemories")},setDimensions:function(t,e){t.commit("setDimensions",e),t.commit("setScales")}}});n["default"].use(a["a"]),n["default"].config.productionTip=!1;var xt=new a["a"]({routes:[{path:"/",component:ft},{path:"/review/",component:A}]});new n["default"]({router:xt,store:yt,vuetify:b,render:function(t){return t(g)}}).$mount("#app")},"63d0":function(t,e,r){"use strict";r("fdb1")},"67ad":function(t,e,r){"use strict";r("1bf4")},7600:function(t,e,r){},7619:function(t,e,r){"use strict";r("e7ad")},e7ad:function(t,e,r){},fdb1:function(t,e,r){}});
//# sourceMappingURL=app.bbcf1a29.js.map